-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.comments (
  id integer GENERATED ALWAYS AS IDENTITY NOT NULL,
  model_version_id integer NOT NULL,
  comment_text text NOT NULL,
  created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
  user_id integer NOT NULL,
  auth_user_id uuid,
  CONSTRAINT comments_pkey PRIMARY KEY (id),
  CONSTRAINT comments_model_version_id_fkey FOREIGN KEY (model_version_id) REFERENCES public.model_versions(id),
  CONSTRAINT comments_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(user_id)
);
CREATE TABLE public.model_categories (
  id integer NOT NULL,
  model_category character varying NOT NULL UNIQUE,
  CONSTRAINT model_categories_pkey PRIMARY KEY (id)
);
CREATE TABLE public.model_images (
  id integer GENERATED ALWAYS AS IDENTITY NOT NULL,
  model_version_id integer NOT NULL,
  image_path character varying NOT NULL,
  CONSTRAINT model_images_pkey PRIMARY KEY (id),
  CONSTRAINT model_images_model_version_id_fkey FOREIGN KEY (model_version_id) REFERENCES public.model_versions(id)
);
CREATE TABLE public.model_logs (
  id integer GENERATED ALWAYS AS IDENTITY NOT NULL,
  model_id integer NOT NULL,
  log_text text,
  created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
  user_id integer NOT NULL,
  auth_user_id uuid,
  CONSTRAINT model_logs_pkey PRIMARY KEY (id),
  CONSTRAINT model_logs_model_id_fkey FOREIGN KEY (model_id) REFERENCES public.models(id),
  CONSTRAINT model_logs_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(user_id)
);
CREATE TABLE public.model_status (
  id integer NOT NULL,
  status character varying NOT NULL UNIQUE,
  CONSTRAINT model_status_pkey PRIMARY KEY (id)
);
CREATE TABLE public.model_versions (
  id integer NOT NULL,
  model_id integer NOT NULL,
  version integer NOT NULL,
  obj_file_path character varying NOT NULL,
  can_download boolean NOT NULL DEFAULT false,
  created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT model_versions_pkey PRIMARY KEY (id),
  CONSTRAINT model_versions_model_id_fkey FOREIGN KEY (model_id) REFERENCES public.models(id)
);
CREATE TABLE public.models (
  id integer NOT NULL,
  model_name character varying NOT NULL,
  project_id integer NOT NULL,
  model_category_id integer,
  created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
  status_id integer,
  CONSTRAINT models_pkey PRIMARY KEY (id),
  CONSTRAINT models_project_id_fkey FOREIGN KEY (project_id) REFERENCES public.projects(id),
  CONSTRAINT models_model_category_id_fkey FOREIGN KEY (model_category_id) REFERENCES public.model_categories(id),
  CONSTRAINT models_status_id_fkey FOREIGN KEY (status_id) REFERENCES public.model_status(id)
);
CREATE TABLE public.portfolio_page_models (
  id integer GENERATED ALWAYS AS IDENTITY NOT NULL,
  portfolio_page_id integer NOT NULL,
  model_id integer NOT NULL,
  CONSTRAINT portfolio_page_models_pkey PRIMARY KEY (id),
  CONSTRAINT portfolio_page_models_portfolio_page_id_fkey FOREIGN KEY (portfolio_page_id) REFERENCES public.portfolio_pages(id),
  CONSTRAINT portfolio_page_models_model_id_fkey FOREIGN KEY (model_id) REFERENCES public.models(id)
);
CREATE TABLE public.portfolio_pages (
  id integer GENERATED ALWAYS AS IDENTITY NOT NULL,
  portfolio_page_name character varying NOT NULL,
  creator_id integer NOT NULL,
  auth_user_id uuid,
  CONSTRAINT portfolio_pages_pkey PRIMARY KEY (id),
  CONSTRAINT portfolio_pages_creator_id_fkey FOREIGN KEY (creator_id) REFERENCES public.users(user_id)
);
CREATE TABLE public.project_clients (
  id integer GENERATED ALWAYS AS IDENTITY NOT NULL,
  project_id integer NOT NULL,
  user_id integer NOT NULL,
  auth_user_id uuid,
  CONSTRAINT project_clients_pkey PRIMARY KEY (id),
  CONSTRAINT project_clients_project_id_fkey FOREIGN KEY (project_id) REFERENCES public.projects(id),
  CONSTRAINT project_clients_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(user_id)
);
CREATE TABLE public.project_status (
  id integer NOT NULL,
  status character varying NOT NULL UNIQUE,
  CONSTRAINT project_status_pkey PRIMARY KEY (id)
);
CREATE TABLE public.projects (
  id integer NOT NULL,
  project_name character varying NOT NULL,
  event_start_date date,
  project_status_id integer NOT NULL,
  creator_id integer NOT NULL,
  auth_user_id uuid,
  CONSTRAINT projects_pkey PRIMARY KEY (id),
  CONSTRAINT projects_project_status_id_fkey FOREIGN KEY (project_status_id) REFERENCES public.project_status(id),
  CONSTRAINT projects_creator_id_fkey FOREIGN KEY (creator_id) REFERENCES public.users(user_id)
);
CREATE TABLE public.user_favourites (
  id integer GENERATED ALWAYS AS IDENTITY NOT NULL,
  model_version_id integer NOT NULL,
  user_id integer NOT NULL,
  auth_user_id uuid,
  CONSTRAINT user_favourites_pkey PRIMARY KEY (id),
  CONSTRAINT user_favourites_model_version_id_fkey FOREIGN KEY (model_version_id) REFERENCES public.model_versions(id),
  CONSTRAINT user_favourites_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(user_id)
);
CREATE TABLE public.user_roles (
  id integer NOT NULL,
  role character varying NOT NULL UNIQUE,
  CONSTRAINT user_roles_pkey PRIMARY KEY (id)
);
CREATE TABLE public.users (
  user_id integer NOT NULL,
  user_role_id integer NOT NULL,
  email character varying NOT NULL UNIQUE,
  password_hash character varying NOT NULL,
  full_name character varying,
  photo_url character varying,
  created_at timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
  auth_user_id uuid,
  CONSTRAINT users_pkey PRIMARY KEY (user_id),
  CONSTRAINT users_user_role_id_fkey FOREIGN KEY (user_role_id) REFERENCES public.user_roles(id)
);